# Динамическая маршрутизация

## Эмулятор
* GNS3

## Оборудование
* Маршрутизатор Cisco 3745
* Коммутатор (GNS3 built-in switch)

## OSPF
**OSPF (Open Shortest Path First)** - протокол внутренней маршрутизации, который использует отслеживание состояния канала (Link-state) и алгоритм Дейкстры для нахождения кратчайшего пути.

Ключевые понятия:

**LSA (Link State Advertisement)** – объявления о состоянии каналов, которыми маршрутизаторы обмениваются для передачи информации о своих состояниях (интерфейсах, соседях, метриках).

**LSDB (Link State Database)** – база данных состояний каналов, которая хранит все полученные LSA. Она представляет собой локальную карту сети, на основе которой маршрутизатор может выбирать кратчайший путь.

**Area** – логическое объединение маршрутизаторов, которые обмениваются LSA и имеют общую LSDB. Разделение сети на зоны уменьшает объём данных, которые должны обрабатывать маршрутизаторы.

**Area 0 (Backbone Area)** – магистральная зона, через которую проходят маршруты между всеми остальными зонами. Все другие зоны должны быть непосредственно подключены к Area 0.

![image](https://github.com/user-attachments/assets/01ae052a-f036-47fe-b29a-cae18e2f72ce)
![image](https://github.com/user-attachments/assets/2a5fa14e-0f19-4b5f-a3ce-93f024b8055a)

## HSRP
**HSRP (Hot Standby Router Protocol)** — проприетарный протокол Cisco, предназначенный для обеспечения отказоустойчивости шлюза по умолчанию (default gateway) в локальной сети. Относится к семейству FHRP (First-hop Redundancy Protocols).

![image](https://github.com/user-attachments/assets/15ed3450-865f-46ce-a965-992023892b49)

В качестве шлюза по умолчанию для PC1 укажем IP-адрес `10.10.10.10/24`.

Объединим маршрутизаторы R1 и R2 в HSRP-группу `1` с единым виртуальным IP-адресом `10.10.10.10/24`:
> R1# (config-if) `standby 1 ip 10.10.10.10`
> 
> R2# (config-if) `standby 1 ip 10.10.10.10`

После выполнения команды `standby` для HSRP-группы будет сгенерирован виртуальный MAC-адрес `0000.0C07.AC01`, где `01` указывает на номер группы.

Поскольку в нашем случае оба маршрутизатора имеют равный приоритет (100 по умолчанию), статус активного маршрутизатора (Active) получил R1, так как был сконфигурирован раньше. R2 получил статус резервного маршрутизатора (Standby). Теперь R1 отвечает на ARP-запросы для виртуального IP-адреса `10.10.10.10/24`, предоставляя виртуальный MAC-адрес `0000.0C07.AC01`, и обрабатывает входящий трафик. R2 остаётся в режиме ожидания.

![image](https://github.com/user-attachments/assets/0fd50594-2e16-4828-9d11-fdd9ed02da3a)
![image](https://github.com/user-attachments/assets/326a92e3-c897-4503-8034-5803bfed991e)

R1 регулярно отправляет R2 сообщения `Hello`. Если R1 выходит из строя и R2 перестает получать сообщения `Hello`, R2 становится активным маршрутизатором. Для конечных устройств это переключение обычно происходит быстро и незаметно, так как виртуальные IP- и MAC-адреса не меняются.

![image](https://github.com/user-attachments/assets/9f6b7e7c-f621-4a3c-a702-558a5d554a03)
